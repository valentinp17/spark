-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE OR REPLACE TEMPORARY VIEW t1 AS VALUES (0, 1), (1, 2) t(c1, c2)
-- !query analysis
CreateViewCommand `t1`, VALUES (0, 1), (1, 2) t(c1, c2), false, true, LocalTempView, true
   +- SubqueryAlias t
      +- LocalRelation [c1#x, c2#x]


-- !query
SELECT * FROM udtf(1, 2)
-- !query analysis
Project [x#x, y#x]
+- Generate TestUDTF(1, 2)#x, false, [x#x, y#x]
   +- OneRowRelation


-- !query
SELECT * FROM udtf(-1, 0)
-- !query analysis
Project [x#x, y#x]
+- Generate TestUDTF(-1, 0)#x, false, [x#x, y#x]
   +- OneRowRelation


-- !query
SELECT * FROM udtf(0, -1)
-- !query analysis
Project [x#x, y#x]
+- Generate TestUDTF(0, -1)#x, false, [x#x, y#x]
   +- OneRowRelation


-- !query
SELECT * FROM udtf(0, 0)
-- !query analysis
Project [x#x, y#x]
+- Generate TestUDTF(0, 0)#x, false, [x#x, y#x]
   +- OneRowRelation


-- !query
SELECT a, b FROM udtf(1, 2) t(a, b)
-- !query analysis
Project [a#x, b#x]
+- SubqueryAlias t
   +- Project [x#x AS a#x, y#x AS b#x]
      +- Generate TestUDTF(1, 2)#x, false, [x#x, y#x]
         +- OneRowRelation


-- !query
SELECT * FROM t1, LATERAL udtf(c1, c2)
-- !query analysis
Project [c1#x, c2#x, x#x, y#x]
+- LateralJoin lateral-subquery#x [c1#x && c2#x], Inner
   :  +- Generate TestUDTF(outer(c1#x), outer(c2#x))#x, false, [x#x, y#x]
   :     +- OneRowRelation
   +- SubqueryAlias t1
      +- View (`t1`, [c1#x,c2#x])
         +- Project [cast(c1#x as int) AS c1#x, cast(c2#x as int) AS c2#x]
            +- SubqueryAlias t
               +- LocalRelation [c1#x, c2#x]


-- !query
SELECT * FROM t1 LEFT JOIN LATERAL udtf(c1, c2)
-- !query analysis
Project [c1#x, c2#x, x#x, y#x]
+- LateralJoin lateral-subquery#x [c1#x && c2#x], LeftOuter
   :  +- Generate TestUDTF(outer(c1#x), outer(c2#x))#x, false, [x#x, y#x]
   :     +- OneRowRelation
   +- SubqueryAlias t1
      +- View (`t1`, [c1#x,c2#x])
         +- Project [cast(c1#x as int) AS c1#x, cast(c2#x as int) AS c2#x]
            +- SubqueryAlias t
               +- LocalRelation [c1#x, c2#x]


-- !query
SELECT * FROM udtf(1, 2) t(c1, c2), LATERAL udtf(c1, c2)
-- !query analysis
Project [c1#x, c2#x, x#x, y#x]
+- LateralJoin lateral-subquery#x [c1#x && c2#x], Inner
   :  +- Generate TestUDTF(outer(c1#x), outer(c2#x))#x, false, [x#x, y#x]
   :     +- OneRowRelation
   +- SubqueryAlias t
      +- Project [x#x AS c1#x, y#x AS c2#x]
         +- Generate TestUDTF(1, 2)#x, false, [x#x, y#x]
            +- OneRowRelation


-- !query
SELECT * FROM udtf(cast(rand(0) AS int) + 1, 1)
-- !query analysis
[Analyzer test output redacted due to nondeterminism]
